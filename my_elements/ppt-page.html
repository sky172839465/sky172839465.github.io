<dom-module id=ppt-page><style is=custom-style include=app-grid-style>.ppt-content-area{margin:-5% auto;width:100%}.google-signin-area{margin:0 auto 5%}paper-card{width:90%;margin:-3% 5% 7% 5%}.itemTitle{color:var(--paper-grey-600);margin:1% 0;font-size:90%}.card-action-btn-area{width:100%;font-size:80%}a{text-decoration:none;color:var(--paper-green-700)}:host{--app-grid-columns:2}ul{padding:0;list-style:none}.item{list-style:none}</style><template><div class=ppt-content-area><div class=google-signin-area align=center><google-signin id=google-signin client-id=881539947130-7t0poobhr2qi0hjuo4ciko317plpj7t7.apps.googleusercontent.com height=tall width=wide> </google-signin></div><google-signin-aware id=google-signin-aware signed-in={{isSignin}} is-authorized={{isAuthorized}} need-additional-auth={{needAdditionalAuth}} openid-prompt={{openidPromptValue}} scopes=https://www.googleapis.com/auth/drive on-google-signin-aware-success=signSuccess> </google-signin-aware><template is=dom-if if={{isSignin}}><googledrive-detail is-signin={{isSignin}} author={{author}} folder-list-url={{folderListUrl}} file-list={{fileList}} is-file-exist={{isFileExist}} is-loading={{isLoading}}></googledrive-detail><template is=dom-if if={{isFileExist}}><template is=dom-repeat items={{fileList.file}} as=file><paper-card image="{{_adjustContent(file.fileImage, 'img')}}" placeholder-image="{{_adjustContent(file.fileImage, 'ph')}}" preload-image fade-image elevation=1 animated-shadow=true><div class=card-content><div class=itemTitle>{{locales.ppt.fileTitle}}</div><div>{{_adjustContent(file.fileName, 'name')}}</div><div class=itemTitle>{{locales.ppt.fileUpdate}}</div><div>{{_adjustContent(file.fileModifiedTime, 'update')}}</div></div><div class=card-actions><ul class=app-grid><li class=item><div class=card-action-btn-area align=center><a href={{file.fileWebView}} target=block tabindex=-1> <iron-icon icon=own:remove-red-eye></iron-icon> <paper-button noink>{{locales.ppt.fileView}}</paper-button> </a></div><li class=item><div class=card-action-btn-area align=center><a href={{file.fileDownload}} target=block tabindex=-1> <iron-icon icon=own:file-download></iron-icon> <paper-button noink>{{locales.ppt.fileDownload}}</paper-button> </a></div></ul></div></paper-card></template></template></template></div></template><script>Polymer({is:'ppt-page',properties:{locales:{type:JSON,notify:true},isMobile:{type:Boolean,notify:true},author:{type:JSON,notify:true},isSignin:{type:Boolean,notify:true},folderListUrl:{type:String,notify:true},apiKey:{type:String,notify:true},folder:{type:String,notify:true},fileInfo:{type:JSON,notify:true},fileList:{type:JSON,notify:true},isFileExist:{type:Boolean,notify:true},packageList:{type:Array,value:["my_elements/googledrive-detail"]}},ready:function(){for(var i in this.packageList){var packageInfo=this.packageList[i].split("/");var packageItem=document.getElementById(packageInfo[packageInfo.length-1]);if(!Polymer.isInstance(packageItem))
this.importHref(this.packageList[i]+".html");}},attached:function(){if(!this.isMobile)
$(".ppt-content-area").css("width","700px");document.getElementById("spinner").isLoading=false;},error:function(data){console.log(data);},signSuccess:function(data){this.folder="0B4Ljod2L6AiYfkpoZFl2SnRmUmtOSzQ5OTZTRHgwZkVVank5Ulp3a1AzdFhGZHRjZFRJc0E";this.apiKey="AIzaSyA_fs3pu2LfY8Ys6U0G3PeQmk_vvm7VlWk";var user=gapi.auth2.getAuthInstance()['currentUser'].get();this.author={"Authorization":user.Zi.token_type+" "+user.Zi.access_token};this.folderListUrl="https://www.googleapis.com/drive/v2/files/"+this.folder+"/children/?fields=items/id&key="+this.apiKey;},_adjustContent:function(content,type){var newContent="";switch(type){case'ph':newContent=content.split("=")[0]+"=s1";break;case'img':var width="700";if(this.isMobile)
width=$(".ppt-content-area").width();newContent=content.split("=")[0]+"=s"+Math.round(width);break;case'name':newContent=content.split(".pptx")[0];break;case'update':newContent=content.split("T")[0];break;}
return newContent;}});</script></dom-module>